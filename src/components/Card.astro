---
// Importamos el nuevo componente
import { Image } from 'astro:assets';
import WhatsAppButton from './WhatsAppButton.astro';
import type { ImageMetadata } from 'astro';

interface Props {
  name: string;
  role: string;
  photoUrl: ImageMetadata;
  whatsappNumber: string; 
  services: string[];
}

const { name, role, photoUrl, whatsappNumber, services } = Astro.props;
---

<div 
  class="card-container group h-96 w-72 cursor-pointer [perspective:1000px]"
  onclick="this.classList.toggle('is-flipped')"
>
  
  <div class="relative h-full w-full shadow-xl transition-all duration-500 [transform-style:preserve-3d] group-hover:[transform:rotateY(180deg)] [.is-flipped_&]:[transform:rotateY(180deg)] rounded-2xl">
    
    <div class="absolute inset-0 h-full w-full rounded-2xl [backface-visibility:hidden]">
      <div class="flex h-full flex-col items-center justify-center bg-gradient-to-br from-rose-100 via-purple-100 to-indigo-100 p-6 text-center border border-white/50">
        
        <div class="relative mb-4 h-32 w-32">
           <Image width={400} height={600} src={photoUrl} alt={`Foto de ${name}`} class="h-full w-full rounded-full object-cover border-4 border-white shadow-md" />
        </div>

        <h2 class="mb-1 text-2xl font-bold text-gray-800">{name}</h2>
        <p class="mb-6 text-sm font-medium text-gray-500 uppercase tracking-wide">{role}</p>

        <div onclick="event.stopPropagation()">
            <WhatsAppButton 
              phone={whatsappNumber} 
              label="Agendar Cita"
              message={`Hola ${name}, me interesa conocer mÃ¡s sobre tus servicios de ${role}.`}
            />
        </div>

      </div>
    </div>

    <div class="absolute inset-0 h-full w-full rounded-2xl [backface-visibility:hidden] [transform:rotateY(180deg)]">
      <div class="flex h-full flex-col items-center justify-center bg-gradient-to-bl from-teal-100 via-emerald-100 to-lime-100 p-8 text-center border border-white/50">
        <h3 class="mb-4 text-xl font-bold text-teal-800">Mis Servicios</h3>
        <ul class="space-y-3 text-left">
          {services.map((service) => (
            <li class="flex items-start text-gray-700">
              <span class="mr-2 mt-1 block h-2 w-2 rounded-full bg-teal-500"></span>
              <span class="text-sm font-medium leading-tight">{service}</span>
            </li>
          ))}
        </ul>
        
        <div class="mt-6" onclick="event.stopPropagation()">
           <WhatsAppButton phone={whatsappNumber} label="Chat" />
        </div>
      </div>
    </div>
    
  </div>
</div>